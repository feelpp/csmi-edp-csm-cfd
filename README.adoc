:feelpp: Feel++
= TP 3
:stem: latexmath

== Elasticité Linéaire

=== Partie 1

On considère le domaine suivant soit stem:[\Omega=\]0, L[\times \] 0,1[ ] et l'on note stem:[\Gamma_{i}] les quatre côtés du bord, numérotés dans le sens inverse des aiguilles d'une montre et avec stem:[\Gamma_{1}] le bord du bas. 

Le problème d'élasticité linéaire s'écrit:
[stem]
++++
\begin{aligned}
\nabla \cdot \sigma(u) &=f \mbox{ dans } \Omega\\
\sigma(u) &=2 \mu \varepsilon(u) + \lambda(\nabla \cdot u) \mathrm{Id}\\
u&=0 \mbox{ sur } \Gamma_{1} \\
\sigma(u) n& =0 \mbox{ sur } \Gamma_{2} \cup \Gamma_{3} \cup \Gamma_{3}
\end{aligned}
++++
avec stem:[\lambda, \mu] les coefficients de Lamé

. Créer le maillage du domaine stem:[\Omega].
. Ecrire la formulation variationnelle, puis mettre en place la configuration pour {feelpp} en prenant pour données stem:[f=(0,1)^{T}] et stem:[\mu=\lambda=1]
. Visualiser la déformation du maillage obtenue à l'aide la fonction WarpByVector

image::paraview-warpbyvector.png[]

. Ajouter sur le maillage déformé la visualisation  de la norme de Frobénius du tenseur des contrainte stem:[\sigma(u)] ainsi que des champs Von-Mises et Tresca. Commenter en vous aidant d'une petite recherche sur les champs précédents (Von-Mises...) par exemple sur Wikipedia.

=== Partie 2: Perte de coercivité. 

On ajoute à présent deux trous circulaires dans le domaine précédent.

.Poutre trouée
image::poutre-avectrous.png[]

On fixe la poutre sur les bords gauche et droite et on la pince: on exerce donc une pression constante
sur le bord du bas (force dirigée vers le haut) et sur le bord du haut (force dirigée vers le bas).

. Créer le maillage et la configuration {feelpp} associé au problème.
. Comparer les solutions obtenues avec stem:[\lambda / \mu=1] et stem:[\lambda / \mu=10^{3} .] Afficher les lignes de niveau associé au déplacement vectical stem:[u_{2} .] À cette fin, on utilisera le préconditionneur diagonal (Jacobi) `--solid.pc-type jacobi` et on affichera les itérations `--solid.ksp-monitor=1`. Commenter.

== Stokes

=== Partie 1: Eléments finis stables. 

On considère le problème de Stokes suivant:
[stem]
++++
\begin{aligned}
-\Delta u+\nabla p &=f \text{ dans } \Omega \times \mathbb{R}^{+} \\
\nabla \cdot u &=0 \\
u&=g \text{ sur } \partial \Omega \times \mathbb{R}^{+}
\end{aligned}
++++


Une solution exacte est donnée par la solution de Kovasznay:
[stem]
++++
u=\left[\begin{array}{c}
1-e^{\lambda x} \cos (2 \pi y) \\
\frac{\lambda}{2 \pi} e^{\lambda x} \sin (2 \pi y)
\end{array}\right], \quad p(x, y)=-\frac{e^{2 \lambda x}}{2}+C
++++
avec stem:[\lambda=1 /(2 \nu)-\sqrt{1 /\left(4 \nu^{2}\right)+4 \pi^{2}}, C \in \mathbb{R}] une constante et le second membre stem:[f] est déterminé de telle sorte que stem:[u] soit solution.

On considère le domaine stem:[\Omega=(-0.5,1) \times(-0.5,1.5)] et stem:[\nu=0.035 .] 
Les conditions de Dirichlet sur le bord sont obtenues en évaluant la solution exacte.

. Déterminer stem:[f] de telle sorte que stem:[u] soit solution puis stem:[C \in \mathbb{R}] tel que stem:[p] soit à moyenne nulle sur stem:[\Omega].
. Créer le maillage du domaine stem:[\Omega].
. Ecrire la formulation variationnelle pour le problème suivant:
[stem]
++++
\begin{aligned}
-\Delta u+\nabla p&=f, \quad \text{dans} \Omega\\
\nabla \cdot u &=0 \\ 
u &=g \text{ sur } \partial \Omega
\end{aligned}
++++

. Considérer les éléments stem:[P_{2} / P_{1}] et calculer la moyenne de la pression. Commenter.
. Faire une analyse de convergence en vitesse et pression pour les éléments stem:[P_{2} / P_{1}].


=== Partie 2: Stokes instationnaire. 

On considère le problème suivant
[stem]
++++
\begin{aligned} 
\partial_{t} u-\nu \Delta u+\nabla p &=f, & & \text { dans } \Omega \times[0, T] \\ 
\nabla \cdot u &=0 & & \\ 
u &=g_{D}, & & \operatorname{sur} \Gamma_{i n} \times[0, T] \\ 
u &=0, & & \operatorname{sur} \Gamma_{0} \times[0, T] \\ 
\nu \partial_{n} u-p n &=g_{N}, & & \operatorname{sur} \Gamma_{o u t} \times[0, T] \\ 
u(0, x) &=u_{i n i t}(x), & & \operatorname{sur} \Gamma 
\end{aligned}
++++
où 

* stem:[u: \Omega \times[0, T\] \rightarrow \mathbb{R}^{2}] est le champ de vitesse, 
* stem:[p: \Omega \times[0, T\] \rightarrow \mathbb{R}] la pression. 

Le bord du domaine est décomposée en 3 partie stem:[: \partial \Omega=\Gamma_{i n} \cup \Gamma_{\text {out}} \cup \Gamma_{0}].

. Effectuer une semi-discrétisation en temps et écrire le problème variationnel.

On considère le domaine suivant

image::square.png[]

* Sur la partie bleue du bord stem:[\left(\Gamma_{i n}\right),] on impose un profile de vitesse parabolique stem:[ g_{D}(x, y)=(4 y(1-y), 0)^{T}] 
* Sur les parties noires du bord stem:[\left(\Gamma_{0}\right),] on impose des conditions de Dirichlet homogène : stem:[g_{D}(x, y)=(0,0)^{T}] 
* Sur la partie rouge du bord (stem:[\Gamma _{\text {out}}] ) aucune contrainte n'est exercée (sortie libre): cela correspond à des conditions de type Neumann homogène : stem:[g_{N}(x, y)=(0,0)^{T} .] 
* Enfin, aucune force extérieure n'est exercée
sur le fluide : stem:[f=0] 

La donnée initiale est donnée par:
[stem]
++++
u_{i n i t}(x, y)=\left\{\begin{array}{ll}
(4 y(1-y), 0)^{T}, & \text { si }(x, y) \in \Gamma_{i n} \\
(0,0)^{T}, & \text { sinon. }
\end{array}\right.
++++
et les paramètres sont stem:[\nu=0.005] et stem:[T=40 .]

[start=2]
. Programmer la méthode avec la toolbox fluid(CFD) en mode Navier-Stokes
. Calculer le trainée et la portance, les afficher et commenter
. Diminuer la viscosité du fluide(prenez trois valeurs différentes), qu'observez vous ?
